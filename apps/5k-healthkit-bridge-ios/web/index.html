<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>5K Tracker (iOS Wrapper)</title>
    <style>
      body{font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;margin:0;padding:24px}
      .wrap{max-width:720px;margin:0 auto}
      code{background:#f3f3f3;padding:2px 6px;border-radius:4px}
      .cta{display:inline-block;margin-top:12px;padding:10px 14px;background:#007aff;color:#fff;border-radius:8px;text-decoration:none}
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>5K Tracker â€” iOS Wrapper</h1>
      <p>This is a minimal Capacitor shell around your existing 5K Tracker PWA.
         Build the native iOS project and enable HealthKit in Xcode to bridge Apple Health data.
      </p>
      <p>
        During development you can point this wrapper to your running PWA by setting a server URL in
        <code>capacitor.config.ts</code> (e.g. <code>http://localhost:5001</code>), then run <code>npx cap sync ios</code>.
      </p>
      <p>
        HealthKit bridge TypeScript interface lives at <code>src/healthkit.ts</code>. The native implementation is added in Xcode.
      </p>
      <a class="cta" href="#" onclick="alert('Open the native iOS app build from Xcode to test.');return false;">Open in iOS</a>
      <p>Test HealthKit plugin (native or web mock):</p>
      <button id="check">Check Availability</button>
      <button id="auth">Request Authorization</button>
      <button id="save">Save Test Workout</button>
      <pre id="out"></pre>
    </div>
    <script>
      (function(){
        const out = document.getElementById('out');
        const plugin = (window.Capacitor && window.Capacitor.Plugins && window.Capacitor.Plugins.HealthKit)
          ? window.Capacitor.Plugins.HealthKit
          : {
              isAvailable: async () => ({ available: false }),
              requestAuthorization: async () => ({ granted: true }),
              saveWorkout: async (opts) => { console.log('Mock saveWorkout', opts); return { success: true }; }
            };

        document.getElementById('check').addEventListener('click', async () => {
          try { const r = await plugin.isAvailable(); out.textContent = JSON.stringify(r, null, 2); }
          catch (e) { out.textContent = 'Error: ' + (e && e.message || e); }
        });
        document.getElementById('auth').addEventListener('click', async () => {
          try { const r = await plugin.requestAuthorization({ read: ['HKQuantityTypeIdentifierDistanceWalkingRunning'], write: [] }); out.textContent = JSON.stringify(r, null, 2); }
          catch (e) { out.textContent = 'Error: ' + (e && e.message || e); }
        });
        document.getElementById('save').addEventListener('click', async () => {
          const now = new Date();
          try { const r = await plugin.saveWorkout({ activityType: 'running', distanceMeters: 5000, startDate: now.toISOString(), endDate: now.toISOString() }); out.textContent = JSON.stringify(r, null, 2); }
          catch (e) { out.textContent = 'Error: ' + (e && e.message || e); }
        });
      })();
    </script>
  </body>
</html>
